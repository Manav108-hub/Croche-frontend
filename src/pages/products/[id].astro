---
import Layout from '../../layouts/Layout.astro';
import ProductDetails from '../../components/shop/ProductDetails';
import { api } from '../../utils/api';
import type { Product } from '../../types';

const { id } = Astro.params;

if (!id) {
  return new Response(null, {
    status: 404,
    statusText: 'Not Found'
  });
}

// Fetch product data
let product;
try {
  const response = await api.getProduct(id);
  product = response.product;
} catch (error) {
  return new Response(null, {
    status: 404,
    statusText: 'Product Not Found'
  });
}
---

<Layout>
  <ProductDetails product={product} client:load />
</Layout>
